<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Vendor Earnings | MyTickitSpot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    body { margin:0; font-family:Arial,sans-serif; background:#f4f6fb; }
    .sidebar { width:230px; height:100vh; background:#111827; position:fixed; color:#fff; padding:20px; }
    .sidebar h2 { text-align:center; margin-bottom:30px; }
    .sidebar a { display:block; color:#c7d2fe; text-decoration:none; padding:12px; border-radius:6px; margin-bottom:10px; font-size:14px; }
    .sidebar a:hover, .sidebar a.active { background:#1f2937; color:#fff; }
    .main { margin-left:250px; padding:25px; }
    h1{margin-bottom:20px;}
    table { width:100%; background:#fff; border-collapse:collapse; border-radius:10px; overflow:hidden; box-shadow:0 5px 15px rgba(0,0,0,0.08); }
    th, td { padding:14px; border-bottom:1px solid #eee; font-size:14px; text-align:left; }
    th { background:#f1f5f9; }
    .total { font-weight:bold; font-size:16px; margin-top:15px; }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>ðŸŽ« Vendor</h2>
  <a href="vendor-dashboard.html">Dashboard</a>
  <a href="create-event.html">Create Event</a>
  <a href="vendor-bookings.html">Bookings</a>
  <a href="earning.html" class="active">Earnings</a>
  <a href="../index.html" onclick="logout()">Logout</a>
</div>

<div class="main">
  <h1>My Earnings</h1>

  <table id="earningTable">
    <tr>
      <th>Event</th>
      <th>Booking ID</th>
      <th>Tickets Sold</th>
      <th>Total Amount</th>
    </tr>
  </table>

  <div class="total">
    Total Earnings: â‚¹<span id="totalEarning">0</span>
  </div>
</div>

<script>
const user = JSON.parse(localStorage.getItem("loggedInUser"));
if(!user || user.role !== "vendor") window.location.href="login.html";

function logout() {
  localStorage.removeItem("loggedInUser");
  window.location.href="login.html";
}

// Get vendor bookings
const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
const vendorBookings = bookings.filter(b => b.vendor === user.name);

const table = document.getElementById("earningTable");
let total = 0;

vendorBookings.forEach(b=>{
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${b.eventName}</td>
    <td>${b.bookingId}</td>
    <td>${b.qty}</td>
    <td>â‚¹${b.total}</td>
  `;
  table.appendChild(tr);
  total += parseFloat(b.total);
});

document.getElementById("totalEarning").innerText = total.toFixed(2);
</script>

</body>
</html>
