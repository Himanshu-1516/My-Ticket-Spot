<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Bookings | MyTickitSpot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <style>
    body { margin:0;font-family:Arial,sans-serif;background:#f4f6fb; }
    .sidebar { width:230px;height:100vh;background:#111827;position:fixed;color:#fff;padding:20px; }
    .sidebar h2 { text-align:center;margin-bottom:30px; }
    .sidebar a { display:block;color:#c7d2fe;text-decoration:none;padding:12px;border-radius:6px;margin-bottom:10px;font-size:14px; }
    .sidebar a:hover, .sidebar a.active { background:#1f2937;color:#fff; }
    .main { margin-left:250px;padding:25px; }
    h1{margin-bottom:20px;}
    table { width:100%; background:#fff; border-collapse:collapse; border-radius:10px; overflow:hidden; box-shadow:0 5px 15px rgba(0,0,0,0.08); }
    th, td { padding:14px; border-bottom:1px solid #eee; font-size:14px; text-align:left; }
    th { background:#f1f5f9; }
    .btn { padding:6px 10px; border:none; border-radius:4px; font-size:12px; cursor:pointer; background:#4f46e5; color:#fff; }
  </style>
</head>
<body>

<div class="sidebar">
  <h2>ðŸŽŸ Attendee</h2>
  <a href="dashboard.html">Dashboard</a>
  <a href="my-bookings.html" class="active">My Bookings</a>
  <a href="billing.html">Billing</a>
  <a href="#" onclick="logout()">Logout</a>
</div>

<div class="main">
  <h1>My Bookings</h1>

  <table id="bookingsTable">
    <tr>
      <th>Booking ID</th>
      <th>Event</th>
      <th>Vendor</th>
      <th>Tickets</th>
      <th>Total</th>
      <th>Action</th>
    </tr>
  </table>
</div>

<script>
const user = JSON.parse(localStorage.getItem("loggedInUser"));
if(!user || user.role !== "attendee") window.location.href="login.html";

function logout() {
  localStorage.removeItem("loggedInUser");
  window.location.href="login.html";
}

const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
const userBookings = bookings.filter(b => b.email === user.email);

const table = document.getElementById("bookingsTable");

userBookings.forEach(b => {
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td>${b.bookingId}</td>
    <td>${b.eventName}</td>
    <td>${b.vendor}</td>
    <td>${b.qty}</td>
    <td>â‚¹${b.total}</td>
    <td>
      <button class="btn" onclick="viewTicket('${b.bookingId}')">View Ticket</button>
    </td>
  `;
  table.appendChild(tr);
});

function viewTicket(id){
  localStorage.setItem("lastBookingId", id);
  window.location.href = "ticket.html";
}
</script>

</body>
</html>
